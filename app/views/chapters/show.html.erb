<div class="wrapper wrapper--white">

  <div class="content-dashboard content-dashboard--writing">
    <div class="content-writing">
        <%= simple_form_for [@chapter.book, @chapter], html: { class: "form-writing"} do |f| %>
        <%= f.input :title, label: false, input_html: { class: 'content-writing-title' }, placeholder: 'Titre du chapitre' %>
      <div class="content-writing-text">
          <%= f.input :content, label: false, input_html: { class: 'content-writing-text-field editable' } %>
      </div>
    </div>
  </div>
</div>

<div class="bottom-bar">
  <div class="bottom-bar-container">
    <div class="bottom-bar-hidden">HELLO</div>
    <div class="bottom-bar-shown">
      <div class="bottom-bar__go-back">
        <i class="fa fa-long-arrow-left" aria-hidden="true"></i>
          <%= link_to "Retour au livre", book_path(@book), class: "bottom-bar__back-to-book" %>
      </div>
      <% unless @book.word_goal.nil? %>
        <div class="bottom-bar__progress-bar
        <% if @book.wordcount > @book.word_goal %>
        progress-bar--completed">
            <p>Bravo, votre objectif de <%= @book.word_goal %> mots est atteint !</p>
          <% else %>">
            <div id="progress-bar-book"></div>
          <% end %>
        </div>
      <% end %>
      <div class="bottom-bar__save-status">
        <%= f.button :submit, "Enregistrer" %>
      </div>
          <% end %>
    </div>
  </div>

</div>

<!-- https://github.com/yabwe/medium-editor -->

<script src="//cdn.jsdelivr.net/npm/medium-editor@latest/dist/js/medium-editor.min.js"></script>
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/medium-editor@latest/dist/css/medium-editor.min.css" type="text/css" media="screen" charset="utf-8">

<% content_for(:after_js) do %>
  <%= javascript_include_tag 'writing_manifest' %>

  <script>

    var line = new ProgressBar.Line('#progress-bar-book', {
      strokeWidth: 4,
      text: {
        value: '<%= @book.wordcount %>/ <%= @book.word_goal %> mots',
      },
      easing: 'easeIn',
    });

    $(document).ready(function(){

      line.animate('<%= @book.word_goal_ratio %>', {
        duration: 800,
        from: { color: '#eee' },
        to: { color: '#000' },
      }, function() {
        console.log("don't look at me!");
      });
    });

  </script>

<% end %>

